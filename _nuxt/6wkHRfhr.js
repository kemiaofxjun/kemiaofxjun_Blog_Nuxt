const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D8vJAWpX.js","./BQPSavj5.js","./entry.BwPk-J5r.css","./Lightbox.DMssNCgq.css"])))=>i.map(i=>d[i]);
import{Z as H,$ as q,d as F,k as f,j as G,a0 as Z,a1 as J,a2 as R,c as i,e as l,s as u,h as p,v as W,g as k,n as m,t as c,C as N,u as Y,a as K,b as Q,o as A,a3 as X,p as E,a4 as tt,f as o,w as L,B as v,x as ot,F as C,r as j,q as et,a5 as D,a6 as nt}from"./BQPSavj5.js";import{a as st}from"./C4e7VoVa.js";import{_ as at}from"./qUrvWENf.js";const lt=H(()=>q(()=>import("./D8vJAWpX.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(g=>g.default||g.default||g)),rt={class:"image"},it=["textContent"],ct=F({__name:"Pic",props:{src:{},mirror:{},caption:{default:""},width:{},height:{},zoom:{type:Boolean,default:!0}},setup(g){const b=g,P=f(()=>st(b.src,b.mirror)),h=G(),d=Z(h),w=J(),{open:x}=w.use(()=>R(lt,{el:d.value,caption:b.caption}));return(_,y)=>{const $=W;return l(),i("figure",rt,[u($,{ref_key:"pic",ref:h,class:"image",style:m({cursor:_.zoom&&"zoom-in"}),src:k(P),alt:_.caption,width:_.width,height:_.height,onClick:y[0]||(y[0]=S=>_.zoom&&k(x)())},null,8,["style","src","alt","width","height"]),_.caption?(l(),i("figcaption",{key:0,"aria-hidden":"",textContent:c(_.caption)},null,8,it)):p("",!0)])}}}),dt=Object.assign(N(ct,[["__scopeId","data-v-17fd35d7"]]),{__name:"Pic"}),ut={class:"essay-stats"},pt={class:"essay-more",href:"https://moment.051531.xyz",target:"_blank",rel:"noopener noreferrer"},_t={class:"page-essay"},vt={class:"talk-container"},gt={key:0,class:"loading-container"},mt={key:1,class:"error-container"},bt={key:2,class:"talks-list"},ht={class:"talk-meta"},kt=["src","alt"],yt={class:"info"},ft={class:"talk-nick"},wt={class:"talk-date"},xt={class:"talk-content"},$t=["innerHTML"],Mt={key:0},Bt={key:1,class:"zone_imgbox"},Ct={key:2,class:"video-container"},Pt=["src"],St=["src"],It=["src"],Tt=["href"],zt={class:"douban-card-left"},At={class:"douban-card-right"},Et={class:"douban-card-item"},Lt={class:"douban-card-item"},jt={class:"douban-card-item"},Dt={class:"douban-card-item"},Ft=["href"],Nt={class:"douban-card-left"},Ot={class:"douban-card-right"},Ut={class:"douban-card-item"},Vt={class:"douban-card-item"},Ht={class:"douban-card-item"},qt={class:"douban-card-item"},Gt={key:5,class:"external-link gradient-card"},Zt=["href"],Jt={class:"link-left"},Rt=["src","alt"],Wt={class:"link-right"},Yt={class:"link-title"},Kt={class:"talk-bottom"},Qt={class:"talk-tags"},Xt={class:"tag"},to=["onClick"],oo=["onClick"],eo=F({__name:"essays",setup(g){const b=Y();K().setAside(["blog-stats","connectivity","blog-log"]),Q({title:"瞬间",meta:[{property:"og:type",content:"profile"},{name:"description",content:`${b.title}的碎碎念页面，记录生活点滴，一些想法和生活。`}]});const h={MEMO_API:"https://moment.051531.xyz/api/memo/list",PAGE_SIZE:30};A(()=>{const a=t=>new Promise((r,n)=>{if(document.querySelector(`script[src="${t}"]`))return r(null);const s=document.createElement("script");s.src=t,s.async=!0,s.onload=r,s.onerror=n,document.head.appendChild(s)});a("https://jsd.myxz.top/npm/aplayer/dist/APlayer.min.js").catch(t=>console.error("脚本加载失败:",t)),a("https://jsd.myxz.top/npm/meting@2/dist/Meting.min.js").catch(t=>console.error("脚本加载失败:",t))});const d=X("essayTalks",()=>({talks:[],loading:!0,error:!1,lastFetchTime:0})),w=f(()=>d.value.talks),x=f(()=>d.value.loading),_=f(()=>d.value.error);function y(a){const t=new Date(a),n=[t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes()].map(s=>s.toString().length===1?`0${s}`:s);return`${n[0]}-${n[1]}-${n[2]} ${n[3]}:${n[4]}`}function $(a){let t=a.content;const r=a.imgs?a.imgs.split(","):[],n=JSON.parse(a.ext||"{}");return t=t.replace(/\[(.*?)\]\((.*?)\)/g,'<a class="talk_content_link" target="_blank" rel="nofollow" href="$2">@$1</a>').replace(/- \[ \]/g,"⚪").replace(/- \[x\]/g,"⚫").replace(/\n/g,"<br>"),t=`<div class="talk_content_text">${t}</div>`,{text:t,images:r.map(s=>s.startsWith("http")?s:`https:${s}`),music:n.music?.type==="tencent"?{type:n.music.type,server:n.music.server,id:n.music.id,api:n.music.api}:null,video:n.video?.type==="bilibili"?{type:"bilibili",url:n.video.value,id:n.video.value.match(/BV\w+/)?.[0]}:n.video?.type==="youtube"?{type:"youtube",url:n.video.value,id:n.video.value.match(/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w-]{11})/)?.[1]}:n.video?.type==="online"?{type:"online",url:n.video.value}:null,doubanMovie:n.doubanMovie?.id?{url:n.doubanMovie.url,title:n.doubanMovie.title,image:n.doubanMovie.image,director:n.doubanMovie.director,rating:n.doubanMovie.rating,runtime:n.doubanMovie.runtime}:null,doubanBook:n.doubanBook?.id?{url:n.doubanBook.url,title:n.doubanBook.title,image:n.doubanBook.image,author:n.doubanBook.author,pubDate:n.doubanBook.pubDate,rating:n.doubanBook.rating}:null,externalLink:a.externalUrl?{url:a.externalUrl,title:a.externalTitle,favicon:a.externalFavicon}:null}}async function S(){const a=Date.now();if(!(a-d.value.lastFetchTime<1800*1e3))try{d.value.loading=!0,d.value.error=!1;const t=await fetch(h.MEMO_API,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({size:h.PAGE_SIZE})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(r.code===0&&r.data?.list){const n=r.data.list.map(s=>({content:$(s),user:{username:s.user.username,nickname:s.user.nickname,avatarUrl:s.user.avatarUrl},date:y(s.createdAt),location:s.location||"",tags:s.tags?typeof s.tags=="string"?s.tags.split(",").filter(M=>M.trim()):s.tags:["无标签"]}));d.value.talks=n,d.value.lastFetchTime=a}}catch(t){console.error("Error fetching talks:",t),d.value.error=!0}finally{d.value.loading=!1}}A(S);function O(a){const t=a.replace(/<[^>]+>/g,""),r=document.querySelector(".tk-input .el-textarea__inner");r&&(r.value=`> ${t}

`,r.focus(),r.scrollIntoView({behavior:"smooth",block:"center"}))}function U(a){if(!a)return;const t=`https://www.google.com/maps/search/${encodeURIComponent(a)}`;window.open(t,"_blank")}return(a,t)=>{const r=ot,n=E("PageBanner"),s=E("meting-js"),M=dt,V=at,I=tt("tip");return l(),i(C,null,[u(n,{title:"瞬间",subtitle:"记录生活点滴，一些想法",image:"https://lib.bsgun.cn/Hexo-static/img/essay-bg.avif"},{extra:L(()=>[o("div",ut,[t[1]||(t[1]=o("div",{class:"powered-by"}," Powered by moments ",-1)),o("a",pt,[u(r,{name:"icon-park-twotone:more-app",class:"icon"}),t[0]||(t[0]=v(" 查看更多 ",-1))])])]),_:1}),o("div",_t,[o("div",vt,[u(nt,{name:"fade",mode:"out-in"},{default:L(()=>[k(x)?(l(),i("div",gt,t[2]||(t[2]=[o("div",{class:"loading-spinner"},null,-1),o("p",null,"加载中...",-1)]))):k(_)?(l(),i("div",mt,[u(r,{name:"line-md:alert",class:"error-icon"}),t[3]||(t[3]=o("p",null,"加载失败，请刷新页面重试",-1))])):(l(),i("div",bt,[(l(!0),i(C,null,j(k(w),(e,T)=>(l(),i("div",{key:T,class:"talk-item",style:m({"--delay":`${T*.1}s`})},[o("div",ht,[o("img",{class:"avatar",src:e.user.avatarUrl,alt:e.user.nickname},null,8,kt),o("div",yt,[o("div",ft,[v(c(e.user.nickname)+" ",1),u(r,{name:"material-symbols:verified",class:"verified"})]),o("div",wt,c(e.date),1)])]),o("div",xt,[o("div",{class:"talk_content_text",innerHTML:e.content.text},null,8,$t),e.content.music?(l(),i("div",Mt,[t[4]||(t[4]=o("link",{src:"https://jsd.myxz.top/npm/aplayer/dist/APlayer.min.css",rel:"stylesheet"},null,-1)),e.music.type==="tencent"?(l(),et(s,{key:0,id:e.content.music.id,server:e.content.music.server,api:e.content.music.api},null,8,["id","server","api"])):p("",!0)])):p("",!0),e.content.images.length?(l(),i("div",Bt,[(l(!0),i(C,null,j(e.content.images,(B,z)=>(l(),i("figure",{key:z,class:"img-item"},[u(M,{src:B,zoom:"",class:"talk-img",loading:"lazy",fetchpriority:z===0?"high":"low"},null,8,["src","fetchpriority"])]))),128))])):p("",!0),e.content.video?(l(),i("div",Ct,[e.content.video.type==="bilibili"?(l(),i("iframe",{key:0,src:`//player.bilibili.com/player.html?bvid=${e.content.video.id}&autoplay=0`,scrolling:"no",frameborder:"no",allowfullscreen:"true"},null,8,Pt)):e.content.video.type==="youtube"?(l(),i("iframe",{key:1,src:`https://www.youtube.com/embed/${e.content.video.id}`,frameborder:"0",allowfullscreen:""},null,8,St)):e.content.video.type==="online"?(l(),i("video",{key:2,src:e.content.video.url,controls:"",class:"online-video"},null,8,It)):p("",!0)])):p("",!0),e.content.doubanMovie?(l(),i("a",{key:3,class:"douban-card gradient-card",href:e.content.doubanMovie.url,target:"_blank"},[o("div",{class:"douban-card-bgimg",style:m({backgroundImage:`url('${e.content.doubanMovie.image}')`})},null,4),o("div",zt,[o("div",{class:"douban-card-img",style:m({backgroundImage:`url('${e.content.doubanMovie.image}')`})},null,4)]),o("div",At,[o("div",Et,[t[5]||(t[5]=o("span",null,"电影名: ",-1)),o("strong",null,c(e.content.doubanMovie.title),1)]),o("div",Lt,[t[6]||(t[6]=o("span",null,"导演: ",-1)),v(" "+c(e.content.doubanMovie.director),1)]),o("div",jt,[t[7]||(t[7]=o("span",null,"评分: ",-1)),v(" "+c(e.content.doubanMovie.rating),1)]),o("div",Dt,[t[8]||(t[8]=o("span",null,"时长: ",-1)),v(" "+c(e.content.doubanMovie.runtime),1)])])],8,Tt)):p("",!0),e.content.doubanBook?(l(),i("a",{key:4,class:"douban-card gradient-card",href:e.content.doubanBook.url,target:"_blank"},[o("div",{class:"douban-card-bgimg",style:m({backgroundImage:`url('${e.content.doubanBook.image}')`})},null,4),o("div",Nt,[o("div",{class:"douban-card-img",style:m({backgroundImage:`url('${e.content.doubanBook.image}')`})},null,4)]),o("div",Ot,[o("div",Ut,[t[9]||(t[9]=o("span",null,"书名: ",-1)),o("strong",null,c(e.content.doubanBook.title),1)]),o("div",Vt,[t[10]||(t[10]=o("span",null,"作者: ",-1)),v(" "+c(e.content.doubanBook.author),1)]),o("div",Ht,[t[11]||(t[11]=o("span",null,"出版年份: ",-1)),v(" "+c(e.content.doubanBook.pubDate),1)]),o("div",qt,[t[12]||(t[12]=o("span",null,"评分: ",-1)),v(" "+c(e.content.doubanBook.rating),1)])])],8,Ft)):p("",!0),e.content.externalLink?(l(),i("div",Gt,[o("a",{href:e.content.externalLink.url,target:"_blank",rel:"nofollow"},[o("div",Jt,[o("img",{src:e.content.externalLink.favicon,alt:e.content.externalLink.title},null,8,Rt)]),o("div",Wt,[o("div",Yt,c(e.content.externalLink.title),1),u(r,{name:"material-symbols:chevron-right",class:"icon"})])],8,Zt)])):p("",!0)]),o("div",Kt,[o("div",Qt,[o("span",Xt," 🏷️"+c(Array.isArray(e.tags)?e.tags.join(", "):e.tags),1),e.location?D((l(),i("span",{key:0,class:"location",onClick:B=>U(e.location)},[u(r,{name:"ph:map-pin-bold",class:"location-icon"}),v(" "+c(e.location),1)],8,to)),[[I,`搜索: ${e.location}`]]):p("",!0)]),D((l(),i("button",{class:"comment-btn",onClick:B=>O(e.content.text)},[u(r,{name:"ph:chats-bold",class:"icon"})],8,oo)),[[I,"评论"]])])],4))),128)),t[13]||(t[13]=o("div",{class:"talks-footer"},[o("p",null,"仅显示最近 30 条记录")],-1))]))]),_:1})])]),u(V,{key:"/essay"})],64)}}}),lo=N(eo,[["__scopeId","data-v-28742ef4"]]);export{lo as default};
